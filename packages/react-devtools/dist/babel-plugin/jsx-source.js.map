{"version":3,"sources":["../../src/babel-plugin/jsx-source.ts"],"sourcesContent":["import { declare } from '@babel/helper-plugin-utils';\nimport type { PluginObj, NodePath } from '@babel/core';\nimport * as t from '@babel/types';\n\ninterface PluginOptions {\n    /** Prefix for the data attribute (default: 'vdev') */\n    prefix?: string;\n    /** File patterns to exclude */\n    exclude?: RegExp[];\n}\n\nexport default declare((api, options: PluginOptions): PluginObj => {\n    api.assertVersion(7);\n\n    const prefix = options.prefix || 'vdev';\n    const exclude = options.exclude || [/node_modules/];\n\n    return {\n        name: 'visual-dev-jsx-source',\n        visitor: {\n            JSXOpeningElement(path: NodePath<t.JSXOpeningElement>, state) {\n                const filename = state.filename || '';\n\n                // Check if file should be excluded\n                if (exclude.some(pattern => pattern.test(filename))) {\n                    return;\n                }\n\n                const { line, column } = path.node.loc?.start || {};\n\n                if (!filename || line === undefined) return;\n\n                // Check if attribute already exists\n                const hasAttr = path.node.attributes.some(\n                    attr => t.isJSXAttribute(attr) &&\n                        (attr.name.name === `data-${prefix}-file` ||\n                            attr.name.name === `data-${prefix}-source`)\n                );\n\n                if (hasAttr) return;\n\n                // Use separate attributes to avoid JSON escaping issues with esbuild\n                // Format: data-vdev-file, data-vdev-line, data-vdev-col\n                const fileAttr = t.jsxAttribute(\n                    t.jsxIdentifier(`data-${prefix}-file`),\n                    t.stringLiteral(filename)\n                );\n\n                const lineAttr = t.jsxAttribute(\n                    t.jsxIdentifier(`data-${prefix}-line`),\n                    t.stringLiteral(String(line))\n                );\n\n                const colAttr = t.jsxAttribute(\n                    t.jsxIdentifier(`data-${prefix}-col`),\n                    t.stringLiteral(String(column))\n                );\n\n                path.node.attributes.push(fileAttr, lineAttr, colAttr);\n            },\n        },\n    };\n});\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCAAwB;AAExB,QAAmB;AASnB,IAAO,yBAAQ,oCAAQ,CAAC,KAAK,YAAsC;AAC/D,MAAI,cAAc,CAAC;AAEnB,QAAM,SAAS,QAAQ,UAAU;AACjC,QAAM,UAAU,QAAQ,WAAW,CAAC,cAAc;AAElD,SAAO;AAAA,IACH,MAAM;AAAA,IACN,SAAS;AAAA,MACL,kBAAkB,MAAqC,OAAO;AAC1D,cAAM,WAAW,MAAM,YAAY;AAGnC,YAAI,QAAQ,KAAK,aAAW,QAAQ,KAAK,QAAQ,CAAC,GAAG;AACjD;AAAA,QACJ;AAEA,cAAM,EAAE,MAAM,OAAO,IAAI,KAAK,KAAK,KAAK,SAAS,CAAC;AAElD,YAAI,CAAC,YAAY,SAAS,OAAW;AAGrC,cAAM,UAAU,KAAK,KAAK,WAAW;AAAA,UACjC,UAAU,iBAAe,IAAI,MACxB,KAAK,KAAK,SAAS,QAAQ,MAAM,WAC9B,KAAK,KAAK,SAAS,QAAQ,MAAM;AAAA,QAC7C;AAEA,YAAI,QAAS;AAIb,cAAM,WAAa;AAAA,UACb,gBAAc,QAAQ,MAAM,OAAO;AAAA,UACnC,gBAAc,QAAQ;AAAA,QAC5B;AAEA,cAAM,WAAa;AAAA,UACb,gBAAc,QAAQ,MAAM,OAAO;AAAA,UACnC,gBAAc,OAAO,IAAI,CAAC;AAAA,QAChC;AAEA,cAAM,UAAY;AAAA,UACZ,gBAAc,QAAQ,MAAM,MAAM;AAAA,UAClC,gBAAc,OAAO,MAAM,CAAC;AAAA,QAClC;AAEA,aAAK,KAAK,WAAW,KAAK,UAAU,UAAU,OAAO;AAAA,MACzD;AAAA,IACJ;AAAA,EACJ;AACJ,CAAC;","names":[]}